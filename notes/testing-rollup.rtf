{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf340
\cocoascreenfonts1{\fonttbl\f0\fnil\fcharset0 Monaco;}
{\colortbl;\red255\green255\blue255;\red255\green102\blue0;\red0\green0\blue0;\red0\green0\blue255;
\red191\green0\blue0;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs18 \cf2 ~actionList\cf3  = \cf2 ~agentDB\cf3 .agents[6].currentUnitArray.collect(\{ \cf4 |unit|\cf3  unit[0]\})\
\
\cf2 ~actionList\cf3  = \cf2 ~agentDB\cf3 .agents[0].currentUnitArray.collect(\{ \cf4 |unit|\cf3  [unit[0], unit[2], unit[3], unit[5]]\})\
\
\cf2 ~fake\cf3  = [ [ 701, 0, 3, 0, 240, 400 ], [ 702, 0, 3, 1, 640, 80 ], [ 703, 0, 3, 2, 720, 240 ], [ 704, 0, 3, 3, 960, 80 ], [ 705, 0, 3, 4, 1040, 400 ], [ 706, 0, 3, 5, 1440, 80 ], [ 707, 0, 3, 6, 1520, 80 ], [ 708, 0, 3, 7, 1600, 200 ], [ 709, 0, 3, 8, 1800, 80 ], [ 710, 0, 3, 9, 1880, 200 ], [ 711, 0, 3, 10, 2080, 200 ], [ 712, 0, 3, 11, 2280, 160 ], [ 713, 0, 3, 12, 2440, 80 ], [ 714, 0, 3, 13, 2520, 120 ], [ 715, 0, 3, 14, 2640, 80 ], [ 716, 0, 3, 15, 2720, 280 ], [ 717, 0, 3, 16, 3000, 160 ], [ 2386, 0, 6, 0, 280, 80 ], [ 2387, 0, 6, 1, 360, 80 ], [ 2388, 0, 6, 2, 440, 240 ], [ 2389, 0, 6, 3, 680, 400 ], [ 2390, 0, 6, 4, 1080, 80 ], [ 2391, 0, 6, 5, 1160, 80 ], [ 2392, 0, 6, 6, 1240, 240 ], [ 2393, 0, 6, 7, 1480, 400 ], [ 2394, 0, 6, 8, 1880, 320 ], [ 2395, 0, 6, 9, 2200, 120 ], [ 2396, 0, 6, 10, 2320, 240 ], [ 2397, 0, 6, 11, 2560, 120 ], [ 2398, 0, 6, 12, 2680, 80 ], [ 2399, 0, 6, 13, 2760, 240 ] ]\
\
\cf2 ~actionList\cf3  = \cf2 ~agentDB\cf3 .agents[3].currentUnitArray.collect(\{ \cf4 |unit|\cf3  unit[0..5]\})\
\
\cf2 ~u0\cf3  = \cf2 ~agentDB\cf3 .agents[0].currentUnitArray[0];\
\cf5 //~u0 = ~fake[0];\cf3 \
\cf2 ~curr\cf3  = [\cf2 ~u0\cf3 [0], \cf2 ~u0\cf3 [0], 0];\
\cf2 ~lastCID\cf3  = \cf2 ~u0\cf3 [0];\
\cf2 ~lastSFID\cf3  = \cf2 ~u0\cf3 [2];\
\cf2 ~lastRELID\cf3  = \cf2 ~u0\cf3 [3];\
\cf2 ~combined\cf3  = [];\
\
\cf5 //~agentDB.agents[0].currentUnitArray[1..].do(\{ |unit, i|\cf3 \
\cf2 ~fake\cf3 [1..].do(\{ \cf4 |unit, i|\cf3 \
	[unit[2], \cf2 ~lastSFID\cf3 ].postln;\
	(unit[2] == \cf2 ~lastSFID\cf3 ).if \{\
		((unit[0] == (\cf2 ~lastCID\cf3  + 1)) && (unit[3] == (\cf2 ~lastRELID\cf3  + 1))).if \{\
			\cf2 ~curr\cf3 [1] = unit[0];\
			\cf2 ~curr\cf3 [2] = \cf2 ~curr\cf3 [2] + unit[5];\
		\}\
	\} \{\
		\cf2 ~combined\cf3  = \cf2 ~combined\cf3  ++ [\cf2 ~curr\cf3 ];\
		\cf2 ~curr\cf3  = [unit[0], unit[0], 0];\
	\};\
	\cf2 ~lastCID\cf3  = unit[0];\
	\cf2 ~lastSFID\cf3  = unit[2];\
	\cf2 ~lastRELID\cf3  = unit[3];\
\});\
\cf2 ~combined\cf0  = \cf2 ~combined\cf0  ++ [\cf2 ~curr\cf0 ];\cf3 \
\cf2 ~combined\cf3 	\
\
\cf2 ~agentDB\cf3 .agents[2].currentUnitArray.collect(\{ \cf4 |unit|\cf3  unit[0]\})\
\
~mnfld[\\cutable][701]\
\
\
4.do(\{ |x| x.postln; \})\
}